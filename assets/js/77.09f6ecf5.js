(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{784:function(e,t,a){"use strict";a.r(t);var r=a(10),n=Object(r.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"challenge-1-receive-an-id-token-in-a-fragment-url"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#challenge-1-receive-an-id-token-in-a-fragment-url"}},[e._v("#")]),e._v(" Challenge 1: Receive an ID Token in a Fragment URL")]),e._v(" "),t("h2",{attrs:{id:"here-is-what-you-ll-learn-üéØ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#here-is-what-you-ll-learn-üéØ"}},[e._v("#")]),e._v(" Here is what you'll learn üéØ")]),e._v(" "),t("ul",[t("li",[e._v("How to register an application in Azure AD")]),e._v(" "),t("li",[e._v("How to create an Open ID Connect request to authenticate an user")]),e._v(" "),t("li",[e._v("How to receive an ID token in a "),t("a",{attrs:{href:"https://en.wikipedia.org/wiki/Fragment_identifier",target:"_blank",rel:"noopener noreferrer"}},[e._v("Fragment URL"),t("OutboundLink")],1),e._v(" for receiving information about the authenticated user")])]),e._v(" "),t("p",[e._v("This is very similar to "),t("RouterLink",{attrs:{to:"/day5/challenges/challenge-0.html"}},[e._v("Challenge 0")]),e._v(", except that this time we will receive the "),t("code",[e._v("id_token")]),e._v(" through a fragment URL instead of it being in the body.")],1),e._v(" "),t("h2",{attrs:{id:"table-of-contents"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#table-of-contents"}},[e._v("#")]),e._v(" Table Of Contents")]),e._v(" "),t("ol",[t("li",[t("a",{attrs:{href:"#create-an-aad-application"}},[e._v("Create an AAD Application")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#run-the-token-echo-server"}},[e._v("Run the Token Echo Server")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#create-an-authentication-request"}},[e._v("Create an Authentication Request")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#wrap-up"}},[e._v("Wrap-Up")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#cleanup"}},[e._v("Cleanup")])])]),e._v(" "),t("h2",{attrs:{id:"create-an-aad-application"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#create-an-aad-application"}},[e._v("#")]),e._v(" Create an AAD Application")]),e._v(" "),t("p",[e._v("Before you can authenticate an user you have to register an application in your AAD tenant.")]),e._v(" "),t("h3",{attrs:{id:"azure-cli"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#azure-cli"}},[e._v("#")]),e._v(" Azure CLI")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("az ad app create --display-name challengeidtokenfragment --web-redirect-uris http://localhost:5001/api/tokenechofragment --identifier-uris https://TENANT_DOMAIN_NAME/challengeidtokenfragment --enable-id-token-issuance "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),e._v("\n")])])]),t("p",[e._v("Replace "),t("code",[e._v("TENANT_DOMAIN_NAME")]),e._v(" with the domain name of your Azure AD instance again.")]),e._v(" "),t("h2",{attrs:{id:"run-the-token-echo-server"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#run-the-token-echo-server"}},[e._v("#")]),e._v(" Run the Token Echo Server")]),e._v(" "),t("p",[e._v("Open another shell and run the Token Echo Server from "),t("a",{attrs:{href:"../apps/token-echo-server"}},[t("code",[e._v("day5/apps/token-echo-server")])]),e._v(" in this repository. This helper ASP.NET Core tool is used to echo the token issued by your Azure AD. The tool is listening on port 5001 on your local machine. Tokens are accepted on the route "),t("code",[e._v("http://localhost:5001/api/tokenechofragment")]),e._v(". This is why we initially registered an AAD application with a reply url pointing to "),t("code",[e._v("http://localhost:5001/api/tokenechofragment")]),e._v(".")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("dotnet run\n")])])]),t("h2",{attrs:{id:"create-an-authentication-request"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#create-an-authentication-request"}},[e._v("#")]),e._v(" Create an Authentication Request")]),e._v(" "),t("p",[e._v("Replace "),t("code",[e._v("TENANT_ID")]),e._v(" with your TenantId and "),t("code",[e._v("APPLICATION_ID")]),e._v(" with your ApplicationId. Open a browser and paste the modified request.")]),e._v(" "),t("div",{staticClass:"language-http extra-class"},[t("pre",{pre:!0,attrs:{class:"language-http"}},[t("code",[t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("https")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("//login.microsoftonline.com/TENANT_ID/oauth2/v2.0/authorize?")])]),e._v("\nclient_id=APPLICATION_ID\n&response_type=id_token\n&redirect_uri=http%3A%2F%2Flocalhost%3A5001%2Fapi%2Ftokenechofragment\n&response_mode=fragment\n&scope=openid%20profile\n&nonce=1234\n")])])]),t("p",[e._v("Copy the "),t("code",[e._v("id_token")]),e._v(" value from your browser's address bar, go to "),t("a",{attrs:{href:"https://jwt.ms",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://jwt.ms"),t("OutboundLink")],1),e._v(" and paste the token. Take a minute and have a look at the decoded token.")]),e._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),t("p",[e._v("üìù If you need further information about the issued claims take a look "),t("a",{attrs:{href:"https://docs.microsoft.com/azure/active-directory/develop/id-tokens#header-claims",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),t("OutboundLink")],1),e._v(".")])]),e._v(" "),t("h2",{attrs:{id:"wrap-up"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#wrap-up"}},[e._v("#")]),e._v(" Wrap-Up")]),e._v(" "),t("p",[e._v("This challenge showed how to create a new application in Azure AD and how an user can be authenticated using the Open ID Connect protocol. The full process is described "),t("a",{attrs:{href:"https://docs.microsoft.com/azure/active-directory/develop/v2-protocols-oidc",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),t("OutboundLink")],1),e._v(".")]),e._v(" "),t("h2",{attrs:{id:"cleanup"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cleanup"}},[e._v("#")]),e._v(" Cleanup")]),e._v(" "),t("p",[e._v("Remove the created resources via the Azure CLI:")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("az ad app delete "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--id")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("APPLICATION_ID"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])]),t("p",[t("RouterLink",{attrs:{to:"/day5/challenges/00-challenge.html"}},[e._v("‚óÄ Previous challenge")]),e._v(" | "),t("RouterLink",{attrs:{to:"/day5/"}},[e._v("üîº Day 5")]),e._v(" | "),t("RouterLink",{attrs:{to:"/day5/challenges/02-challenge.html"}},[e._v("Next challenge ‚ñ∂")])],1)])}),[],!1,null,null,null);t.default=n.exports}}]);